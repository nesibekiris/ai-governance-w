<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global AI Governance Matrix 2025 - TechLetter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f0;
            color: #2c3e50;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #2c3e50;
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 300;
            letter-spacing: -1px;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: #7f8c8d;
            margin-bottom: 5px;
        }
        
        .branding {
            font-size: 1rem;
            color: #3498db;
            font-weight: 600;
            margin-top: 5px;
        }
        
        /* Last Updated Banner */
        .last-updated-banner {
            background: #3498db;
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        /* Loading State */
        .loading {
            text-align: center;
            padding: 60px;
            font-size: 1.2rem;
            color: #7f8c8d;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Search and Filter Section */
        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .search-bar {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 15px;
        }
        
        input[type="text"] {
            flex: 1;
            min-width: 200px;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #3498db;
        }
        
        select {
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .export-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 24px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .secondary-button {
            background: #95a5a6;
        }
        
        .secondary-button:hover {
            background: #7f8c8d;
        }
        
        /* View Toggle */
        .view-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .view-button {
            padding: 10px 20px;
            background: #ecf0f1;
            color: #2c3e50;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .view-button.active {
            background: #3498db;
            color: white;
        }
        
        /* Grid View */
        .country-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .country-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .country-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        
        .country-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .country-flag {
            font-size: 3rem;
        }
        
        .country-name {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .last-updated-tag {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #e8f5e9;
            color: #27ae60;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .approach-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 15px;
        }
        
        .comprehensive { background: #e8f5e9; color: #27ae60; }
        .innovation-first { background: #fff3e0; color: #f39c12; }
        .state-led { background: #fce4ec; color: #e91e63; }
        .balanced { background: #e3f2fd; color: #2196f3; }
        
        .country-details {
            display: grid;
            gap: 10px;
        }
        
        .detail-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .detail-icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }
        
        .detail-content {
            flex: 1;
        }
        
        .detail-label {
            font-size: 0.85rem;
            color: #7f8c8d;
            margin-bottom: 2px;
        }
        
        .detail-value {
            font-size: 0.95rem;
            color: #2c3e50;
            font-weight: 500;
        }
        
        /* Table View */
        .table-container {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: #2c3e50;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 500;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .container {
                padding: 10px;
            }
            
            .country-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .search-bar {
                flex-direction: column;
            }
            
            input[type="text"], select {
                width: 100%;
            }
            
            .export-buttons {
                width: 100%;
            }
            
            button {
                flex: 1;
            }
            
            .table-container {
                font-size: 0.85rem;
            }
            
            th, td {
                padding: 10px 5px;
            }
        }
        
        /* Stats Section */
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #3498db;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.95rem;
        }
        
        /* Error State */
        .error {
            background: #fee;
            color: #c00;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }
        
        /* Hidden by default */
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Global AI Governance Matrix</h1>
            <div class="subtitle">Comprehensive Analysis of AI Regulatory Frameworks</div>
            <div class="branding">Prepared by TechLetter.co</div>
        </div>
        
        <!-- Last Updated Banner -->
        <div class="last-updated-banner" id="lastUpdatedBanner">
            Loading latest updates...
        </div>
        
        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <div>Loading AI governance data...</div>
        </div>
        
        <!-- Main Content (Hidden while loading) -->
        <div id="mainContent" class="hidden">
            <!-- Statistics -->
            <div class="stats-section" id="statsSection"></div>
            
            <!-- Controls -->
            <div class="controls">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Search countries, policies, or keywords...">
                    <select id="regionFilter">
                        <option value="">All Regions</option>
                        <option value="Europe">Europe</option>
                        <option value="Americas">Americas</option>
                        <option value="Asia">Asia</option>
                        <option value="Middle East">Middle East</option>
                        <option value="Africa">Africa</option>
                        <option value="Oceania">Oceania</option>
                    </select>
                    <select id="approachFilter">
                        <option value="">All Approaches</option>
                        <option value="comprehensive">Comprehensive</option>
                        <option value="innovation-first">Innovation-First</option>
                        <option value="state-led">State-Led</option>
                        <option value="balanced">Balanced</option>
                    </select>
                </div>
                <div class="export-buttons">
                    <button onclick="exportToCSV()">📊 Export CSV</button>
                    <button onclick="exportToPDF()" class="secondary-button">📄 Export PDF</button>
                    <button onclick="shareLink()" class="secondary-button">🔗 Share</button>
                </div>
            </div>
            
            <!-- View Toggle -->
            <div class="view-toggle">
                <button class="view-button active" onclick="switchView('grid')">Grid View</button>
                <button class="view-button" onclick="switchView('table')">Table View</button>
                <button class="view-button" onclick="switchView('compare')">Compare</button>
            </div>
            
            <!-- Country Grid -->
            <div id="gridView" class="country-grid"></div>
            
            <!-- Table View -->
            <div id="tableView" class="table-container hidden"></div>
            
            <!-- Compare View -->
            <div id="compareView" class="hidden">
                <div class="controls">
                    <h3>Select countries to compare:</h3>
                    <div id="compareCheckboxes" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin: 20px 0;"></div>
                    <button onclick="updateComparison()">Update Comparison</button>
                </div>
                <div id="comparisonTable" class="table-container" style="margin-top: 20px;"></div>
            </div>
        </div>
        
        <!-- Error State -->
        <div id="error" class="error hidden">
            <h3>Unable to load data</h3>
            <p>Please check your internet connection and try again.</p>
            <button onclick="location.reload()">Retry</button>
        </div>
    </div>

    <script>
        // IMPORTANT: Replace this with your actual Google Sheets URL
        const SHEET_ID = '1tkRnWigu6cYCIqCI5v7nlGJu0z-VP0WAHnXz2wgVOX0'; // Replace with your sheet ID
        const SHEET_NAME = 'Countries'; // Name of your sheet tab
        const API_KEY = 'AIzaSyDy_H8yJNIA8WIQHZGUr2brdHcjfTVnpMA'; // Google Sheets API key (public data only)
        
        // Global variables
        let allCountries = [];
        let currentView = 'grid';
        
        // Load data from Google Sheets
        async function loadData() {
            try {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error('Failed to fetch data');
                }
                
                const data = await response.json();
                const rows = data.values;
                
                if (!rows || rows.length < 2) {
                    throw new Error('No data found');
                }
                
                // Parse headers and data
                const headers = rows[0];
                allCountries = rows.slice(1).map(row => {
                    const country = {};
                    headers.forEach((header, index) => {
                        country[header] = row[index] || '';
                    });
                    return country;
                });
                
                // Update UI
                updateLastUpdated();
                updateStats();
                renderCountries();
                setupEventListeners();
                
                // Hide loading, show content
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('mainContent').classList.remove('hidden');
                
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('error').classList.remove('hidden');
            }
        }
        
        // Update last updated banner
        function updateLastUpdated() {
            const lastUpdatedDates = allCountries
                .map(c => new Date(c.lastUpdated))
                .filter(d => !isNaN(d))
                .sort((a, b) => b - a);
            
            if (lastUpdatedDates.length > 0) {
                const mostRecent = lastUpdatedDates[0].toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                document.getElementById('lastUpdatedBanner').innerHTML = 
                    `✨ Last Updated: ${mostRecent} | ${allCountries.length} Countries Tracked | Real-time Updates from Google Sheets`;
            }
        }
        
        // Update statistics
        function updateStats() {
            const stats = {
                countries: allCountries.length,
                totalInvestment: allCountries.reduce((sum, c) => sum + parseFloat(c.investmentTotal || 0), 0),
                activeEnforcement: allCountries.filter(c => c.enforcementActive === 'TRUE').length,
                regions: [...new Set(allCountries.map(c => c.region))].length
            };
            
            document.getElementById('statsSection').innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${stats.countries}</div>
                    <div class="stat-label">Countries Analyzed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">$${(stats.totalInvestment / 1e12).toFixed(1)}T</div>
                    <div class="stat-label">Total AI Investment</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.activeEnforcement}</div>
                    <div class="stat-label">Active Enforcement</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.regions}</div>
                    <div class="stat-label">Regions Covered</div>
                </div>
            `;
        }
        
        // Render countries based on filters
        function renderCountries() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const regionFilter = document.getElementById('regionFilter').value;
            const approachFilter = document.getElementById('approachFilter').value;
            
            const filtered = allCountries.filter(country => {
                const matchesSearch = !searchTerm || 
                    Object.values(country).some(val => 
                        String(val).toLowerCase().includes(searchTerm)
                    );
                const matchesRegion = !regionFilter || country.region === regionFilter;
                const matchesApproach = !approachFilter || country.approach === approachFilter;
                
                return matchesSearch && matchesRegion && matchesApproach;
            });
            
            if (currentView === 'grid') {
                renderGridView(filtered);
            } else if (currentView === 'table') {
                renderTableView(filtered);
            }
            
            // Update compare checkboxes
            updateCompareCheckboxes();
        }
        
        // Render grid view
        function renderGridView(countries) {
            const grid = document.getElementById('gridView');
            
            if (countries.length === 0) {
                grid.innerHTML = '<div style="text-align: center; padding: 40px; color: #7f8c8d;">No countries match your search criteria.</div>';
                return;
            }
            
            grid.innerHTML = countries.map(country => `
                <div class="country-card">
                    <div class="last-updated-tag">${formatDate(country.lastUpdated)}</div>
                    <div class="country-header">
                        <div>
                            <div class="country-flag">${country.flag}</div>
                            <div class="country-name">${country.name}</div>
                        </div>
                    </div>
                    <div class="approach-badge ${country.approach}">${country.approach}</div>
                    
                    <div class="country-details">
                        <div class="detail-item">
                            <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <div class="detail-content">
                                <div class="detail-label">Key Policy</div>
                                <div class="detail-value">${country.keyPolicy}</div>
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div class="detail-content">
                                <div class="detail-label">Investment</div>
                                <div class="detail-value">$${formatInvestment(country.investmentTotal)}</div>
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"></path>
                            </svg>
                            <div class="detail-content">
                                <div class="detail-label">Enforcement</div>
                                <div class="detail-value" style="color: ${country.enforcementActive === 'TRUE' ? '#e74c3c' : '#95a5a6'}">
                                    ${country.enforcementActive === 'TRUE' ? 'Active' : 'Inactive'}
                                </div>
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div class="detail-content">
                                <div class="detail-label">Status</div>
                                <div class="detail-value">${country.status}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Render table view
        function renderTableView(countries) {
            const table = document.getElementById('tableView');
            
            if (countries.length === 0) {
                table.innerHTML = '<div style="text-align: center; padding: 40px; color: #7f8c8d;">No countries match your search criteria.</div>';
                return;
            }
            
            table.innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Country</th>
                            <th>Approach</th>
                            <th>Key Policy</th>
                            <th>Investment</th>
                            <th>Enforcement</th>
                            <th>Last Updated</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${countries.map(country => `
                            <tr>
                                <td><span style="font-size: 1.5rem; margin-right: 10px;">${country.flag}</span>${country.name}</td>
                                <td><span class="approach-badge ${country.approach}">${country.approach}</span></td>
                                <td>${country.keyPolicy}</td>
                                <td>$${formatInvestment(country.investmentTotal)}</td>
                                <td style="color: ${country.enforcementActive === 'TRUE' ? '#e74c3c' : '#95a5a6'}">
                                    ${country.enforcementActive === 'TRUE' ? 'Active' : 'Inactive'}
                                </td>
                                <td>${formatDate(country.lastUpdated)}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }
        
        // Update compare checkboxes
        function updateCompareCheckboxes() {
            const container = document.getElementById('compareCheckboxes');
            container.innerHTML = allCountries.map((country, index) => `
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                    <input type="checkbox" value="${index}" onchange="updateComparisonCount()">
                    <span style="font-size: 1.2rem;">${country.flag}</span>
                    <span>${country.name}</span>
                </label>
            `).join('');
        }
        
        // Update comparison count
        function updateComparisonCount() {
            const checked = document.querySelectorAll('#compareCheckboxes input:checked').length;
            if (checked > 5) {
                alert('Please select up to 5 countries for comparison');
                event.target.checked = false;
            }
        }
        
        // Update comparison table
        function updateComparison() {
            const checked = Array.from(document.querySelectorAll('#compareCheckboxes input:checked'))
                .map(cb => parseInt(cb.value));
            
            if (checked.length < 2) {
                alert('Please select at least 2 countries to compare');
                return;
            }
            
            const selectedCountries = checked.map(index => allCountries[index]);
            const table = document.getElementById('comparisonTable');
            
            table.innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Aspect</th>
                            ${selectedCountries.map(c => `<th>${c.flag} ${c.name}</th>`).join('')}
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Approach</strong></td>
                            ${selectedCountries.map(c => `<td><span class="approach-badge ${c.approach}">${c.approach}</span></td>`).join('')}
                        </tr>
                        <tr>
                            <td><strong>Key Policy</strong></td>
                            ${selectedCountries.map(c => `<td>${c.keyPolicy}</td>`).join('')}
                        </tr>
                        <tr>
                            <td><strong>Philosophy</strong></td>
                            ${selectedCountries.map(c => `<td>${c.philosophy}</td>`).join('')}
                        </tr>
                        <tr>
                            <td><strong>Investment</strong></td>
                            ${selectedCountries.map(c => `<td>$${formatInvestment(c.investmentTotal)}</td>`).join('')}
                        </tr>
                        <tr>
                            <td><strong>Infrastructure</strong></td>
                            ${selectedCountries.map(c => `<td>${c.infrastructure}</td>`).join('')}
                        </tr>
                        <tr>
                            <td><strong>Enforcement</strong></td>
                            ${selectedCountries.map(c => `<td style="color: ${c.enforcementActive === 'TRUE' ? '#e74c3c' : '#95a5a6'}">${c.enforcementActive === 'TRUE' ? 'Active' : 'Inactive'}</td>`).join('')}
                        </tr>
                        <tr>
                            <td><strong>Penalties</strong></td>
                            ${selectedCountries.map(c => `<td>${c.penalties}</td>`).join('')}
                        </tr>
                        <tr>
                            <td><strong>Last Updated</strong></td>
                            ${selectedCountries.map(c => `<td>${formatDate(c.lastUpdated)}</td>`).join('')}
                        </tr>
                    </tbody>
                </table>
            `;
        }
        
        // Switch view
        function switchView(view) {
            currentView = view;
            
            // Update buttons
            document.querySelectorAll('.view-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show/hide views
            document.getElementById('gridView').classList.toggle('hidden', view !== 'grid');
            document.getElementById('tableView').classList.toggle('hidden', view !== 'table');
            document.getElementById('compareView').classList.toggle('hidden', view !== 'compare');
            
            if (view !== 'compare') {
                renderCountries();
            }
        }
        
        // Export to CSV
        function exportToCSV() {
            const headers = ['Country', 'Flag', 'Region', 'Approach', 'Key Policy', 'Status', 'Philosophy', 
                           'Investment (USD)', 'Infrastructure', 'Enforcement Active', 'Penalties', 'Last Updated'];
            
            const rows = allCountries.map(c => [
                c.name,
                c.flag,
                c.region,
                c.approach,
                c.keyPolicy,
                c.status,
                c.philosophy,
                c.investmentTotal,
                c.infrastructure,
                c.enforcementActive,
                c.penalties,
                c.lastUpdated
            ]);
            
            let csv = headers.join(',') + '\n';
            rows.forEach(row => {
                csv += row.map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(',') + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ai-governance-matrix-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }
        
        // Export to PDF (simple print)
        function exportToPDF() {
            window.print();
        }
        
        // Share link
        function shareLink() {
            const url = window.location.href;
            if (navigator.share) {
                navigator.share({
                    title: 'Global AI Governance Matrix',
                    text: 'Check out this comprehensive analysis of AI regulatory frameworks worldwide',
                    url: url
                });
            } else {
                navigator.clipboard.writeText(url);
                alert('Link copied to clipboard!');
            }
        }
        
        // Format investment amount
        function formatInvestment(amount) {
            const num = parseFloat(amount) || 0;
            if (num >= 1e12) return (num / 1e12).toFixed(1) + 'T';
            if (num >= 1e9) return (num / 1e9).toFixed(0) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(0) + 'M';
            return num.toFixed(0);
        }
        
        // Format date
        function formatDate(dateStr) {
            if (!dateStr) return 'N/A';
            const date = new Date(dateStr);
            if (isNaN(date)) return dateStr;
            
            const now = new Date();
            const diffDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays <= 7) return `${diffDays} days ago`;
            
            return date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric',
                year: 'numeric'
            });
        }
        
        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', renderCountries);
            document.getElementById('regionFilter').addEventListener('change', renderCountries);
            document.getElementById('approachFilter').addEventListener('change', renderCountries);
        }
        
        // Initialize on page load
        window.addEventListener('DOMContentLoaded', loadData);
        
        // Auto-refresh every 5 minutes
        setInterval(loadData, 5 * 60 * 1000);
    </script>
</body>
</html>
